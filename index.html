<!DOCTYPE html>
<html>
	<head>
		<title>CameraTheremin</title>
		<link href="style/favicon.ico" rel="icon" type="image/x-icon" />
		<link rel="stylesheet" type="text/css" href="style/style.css">
		<script src="js/Tone.min.js"></script>
		<script src="js/buttons.js"></script>
		<script src="js/script.js"></script>
		<script>
			var started = false;
			var playing = false;
			var synth = new Tone.SimpleSynth().toMaster();
			var oldfreq = -1;
			function start(){ 
				if(!started){
					synth.triggerAttack(oldfreq);	
					document.getElementById("strt").innerHTML = "Stop theremin";
				} else{
					synth.triggerRelease();
					document.getElementById("strt").innerHTML = "Start theremin ";
					document.getElementById("freq").innerHTML = "Frequency: 0 Hz";
					document.getElementById("count").innerHTML = "Detected area: 0 px";
				}
				started = !started;
				dogaussblur = !dogaussblur;
				dothresh = !dothresh;
				docrop = !docrop;
				doColorChange = !doColorChange;	
			}
			function playSynth(freq){
				document.getElementById("freq").innerHTML = "Frequency: "+freq+" Hz";
				if(freq>0){
					synth.setNote(freq);
				}
				oldfreq = freq;
			}
		</script>
	</head>

	<body class="zoom">
		<video id="vid" hidden></video>
		<canvas id="c"></canvas>
		<br>
		<div id="mainControls">
		<button id="strt" onclick="start()">Start theremin</button>
		<button id="cbutton" onclick="setcont()">continuous</button>
		<button onclick="setcalibrate()">calibrate</button>
		</div>
		<br>
		<div id="calibration">
			<button onclick="threshup(true)">thresh+</button>
			<button onclick="threshup(false)">thresh-</button>			
			<br>
			<br>
				<button onclick="xsdelta(true)">xs+</button>
				<button onclick="xsdelta(false)">xs-</button>
				<button onclick="xedelta(true)">xe+</button>
				<button onclick="xedelta(false)">xe-</button>
			<br>
				<br>
				<button onclick="ysdelta(true)">ys+</button>
				<button onclick="ysdelta(false)">ys-</button>
				<button onclick="yedelta(true)">ye+</button>
				<button onclick="yedelta(false)">ye-</button>
			<br>
				<br>
				<button onclick="nthreshdelta(true)">+</button>
				<button onclick="nthreshdelta(false)">-</button>
			<br>
				<br>
				<button onclick="setbinsub()">binsub</button>
				<button onclick="stUp()">st+</button>
				<button onclick="stdn()">st-</button>
			<br>
				<br>
				<button onclick="setmax()">set max</button>
				<button onclick="setmin()">set min</button>
				<button onclick="clearmaxmin()">clear</button>
			<br>
			<p id="subThresh" hidden>subtractor threshold = 10</p>
			<p id="maxval" align="center"></p>
			<p id="minval" align="center"></p>
			<p id="count" align="center"></p>
		</div>
		<p id="freq" align="center"></p>
	</body>
